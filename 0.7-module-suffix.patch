--- origsrc/gjs-0.7/gjs/importer.c	2010-05-03 12:58:00.000000000 -0500
+++ src/gjs-0.7/gjs/importer.c	2010-06-07 21:31:29.131913100 -0500
@@ -509,7 +509,7 @@ do_import(JSContext  *context,
     result = JS_FALSE;
 
     filename = g_strdup_printf("%s.js", name);
-    native_filename = g_strdup_printf("%s.so", name);
+    native_filename = g_strdup_printf("%s."G_MODULE_SUFFIX, name);
     full_path = NULL;
     directories = NULL;
 
@@ -820,7 +820,7 @@ importer_new_enumerate(JSContext  *conte
                 if (g_file_test(full_path, G_FILE_TEST_IS_DIR)) {
                     g_ptr_array_add(iter->elements, g_strdup(filename));
                 } else {
-                    if (g_str_has_suffix(filename, ".so") ||
+                    if (g_str_has_suffix(filename, "."G_MODULE_SUFFIX) ||
                         g_str_has_suffix(filename, ".js")) {
                         g_ptr_array_add(iter->elements,
                                         g_strndup(filename, strlen(filename) - 3));
